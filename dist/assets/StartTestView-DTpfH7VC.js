import{a as d}from"./axios-CCb-kr4I.js";import"./index-VWaDGczM.js";import{M as g}from"./MessageBox-0nsJUQNC.js";import{_ as p,c as i,a as _,n as f,b as n,t as a,F as x,g as y,e as c,d as T,r as v,o as r}from"./index-8h1Nx-m4.js";const N={components:{MessageBoxVue:g},props:["stid","yname"],data(){return{tdata:null,currindex:0,userp:0,ise:!1,d:null,msg:{type:"info",message:"Test",msg_:"z_Minus"}}},mounted(){d.post("/user/get/test",{stid:this.stid}).then(s=>{s.data&&s.data.ft?(this.tdata=s.data.ft,console.log("Test data got: ",this.tdata)):console.error("No data found in response")}).catch(s=>{this.MSGAnim("Тест не знайдено","error"),console.error("Error at got some test data: ",s)})},methods:{Next(s){setTimeout(()=>{console.log(`Current question index: ${this.currindex}`),console.log(`Selected answer index: ${s}`);const t=this.tdata.questions[this.currindex],o=Number(t.Points);this.currindex<this.tdata.questions.length-1?(console.log(`Current question points: ${o}`),console.log(`Is correct answer: ${t.answers[s].TF}`),t.answers[s].TF&&(isNaN(o)?console.error(`Invalid points value after conversion: ${o}`):(this.userp+=o,console.log(`Correct answer! Points added: ${o}. Total points: ${this.userp}`))),this.currindex++):(console.log(`Final question points: ${o}`),console.log(`Is correct answer on the final question: ${t.answers[s].TF}`),t.answers[s].TF&&(isNaN(o)?console.error(`Invalid points value after conversion: ${o}`):(this.userp+=o,console.log(`Correct answer on the last question! Points added: ${o}. Total points: ${this.userp}`))),this.ise=!0,this.EndTest())},1e3)},async EndTest(){if(this.ise){const s={testname:this.tdata.name,yName:this.yname,points:this.userp,uid:this.tdata.uid};try{const t=await d.post("/user/send/test",{message:{e1:`Ім'я тесту: ${s.testname}`,e2:`Хто пройшов: ${s.yName}`,e3:`Набрані бали: ${s.points}`},uid:s.uid});console.log("Succefuly test send: ",t)}catch(t){this.MSGAnim("Тест не відправлено","error"),console.error("Error to send test: ",t)}}},MSGAnim(s,t){this.msg.message=s,this.msg.type=t,this.msg.msg_="",this.$nextTick(()=>{this.msg.msg_="z_Plus",setTimeout(()=>{this.msg.msg_="z_Minus"},3e3)})}},watch:{}},q={id:"dh1"},w={id:"dhc1"},k={key:0},C={key:1},M={id:"dh2"},V={key:0,id:"form",class:"slide-in"},F=["onClick"],S={key:0,id:"modal"},B={class:"modal-content"},E={for:""};function I(s,t,o,b,e,u){const m=v("MessageBoxVue");return r(),i("main",null,[_(m,{class:f([e.msg.msg_,"msg"]),message:e.msg.message,messageType:e.msg.type},null,8,["class","message","messageType"]),n("div",q,[n("div",w,[e.tdata&&e.tdata.questions&&e.tdata.questions.length>0?(r(),i("h2",k,a(e.tdata.questions[e.currindex].name),1)):(r(),i("h2",C,"Завантаження..."))])]),n("div",M,[e.tdata&&e.tdata.questions&&e.tdata.questions.length>0?(r(),i("div",V,[(r(!0),i(x,null,y(e.tdata.questions[e.currindex].answers||[],(h,l)=>(r(),i("li",{onClick:z=>u.Next(l),id:"f-dh1",key:l},[n("label",null,a(h.name),1)],8,F))),128))])):c("",!0)]),e.ise?(r(),i("div",S,[n("div",B,[n("h1",null,a(e.tdata.name),1),n("h2",null,"Тест створив "+a(e.tdata.tname),1),t[0]||(t[0]=T()),t[1]||(t[1]=n("br",null,null,-1)),n("h3",E,"Ваші бали: "+a(e.userp),1)])])):c("",!0)])}const D=p(N,[["render",I],["__scopeId","data-v-a72e01f6"]]);export{D as default};
